/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { Subject } from 'rxjs';
/**
 * @record
 */
import * as ɵngcc0 from '@angular/core';
export function ScrollSpy() { }
if (false) {
    /** @type {?} */
    ScrollSpy.prototype.id;
    /** @type {?} */
    ScrollSpy.prototype.links;
}
var ScrollSpyService = /** @class */ (function () {
    function ScrollSpyService() {
        this.scrollSpys = [];
        this.activeSubject = new Subject();
        this.active$ = this.activeSubject;
    }
    /**
     * @param {?} scrollSpy
     * @return {?}
     */
    ScrollSpyService.prototype.addScrollSpy = /**
     * @param {?} scrollSpy
     * @return {?}
     */
    function (scrollSpy) {
        this.scrollSpys.push(scrollSpy);
    };
    /**
     * @param {?} scrollSpyId
     * @return {?}
     */
    ScrollSpyService.prototype.removeScrollSpy = /**
     * @param {?} scrollSpyId
     * @return {?}
     */
    function (scrollSpyId) {
        /** @type {?} */
        var scrollSpyIndex = this.scrollSpys.findIndex((/**
         * @param {?} spy
         * @return {?}
         */
        function (spy) {
            return spy.id === scrollSpyId;
        }));
        this.scrollSpys.splice(scrollSpyIndex, 1);
    };
    /**
     * @param {?} scrollSpyId
     * @param {?} activeLinkId
     * @return {?}
     */
    ScrollSpyService.prototype.updateActiveState = /**
     * @param {?} scrollSpyId
     * @param {?} activeLinkId
     * @return {?}
     */
    function (scrollSpyId, activeLinkId) {
        /** @type {?} */
        var scrollSpy = this.scrollSpys.find((/**
         * @param {?} spy
         * @return {?}
         */
        function (spy) {
            return spy.id === scrollSpyId;
        }));
        if (!scrollSpy) {
            return;
        }
        /** @type {?} */
        var activeLink = scrollSpy.links.find((/**
         * @param {?} link
         * @return {?}
         */
        function (link) {
            return link.id === activeLinkId;
        }));
        this.setActiveLink(activeLink);
    };
    /**
     * @param {?} scrollSpyId
     * @param {?} activeLinkId
     * @return {?}
     */
    ScrollSpyService.prototype.removeActiveState = /**
     * @param {?} scrollSpyId
     * @param {?} activeLinkId
     * @return {?}
     */
    function (scrollSpyId, activeLinkId) {
        /** @type {?} */
        var scrollSpy = this.scrollSpys.find((/**
         * @param {?} spy
         * @return {?}
         */
        function (spy) {
            return spy.id === scrollSpyId;
        }));
        if (!scrollSpy) {
            return;
        }
        /** @type {?} */
        var activeLink = scrollSpy.links.find((/**
         * @param {?} link
         * @return {?}
         */
        function (link) {
            return link.id === activeLinkId;
        }));
        if (!activeLink) {
            return;
        }
        activeLink.active = false;
        activeLink.detectChanges();
    };
    /**
     * @param {?} activeLink
     * @return {?}
     */
    ScrollSpyService.prototype.setActiveLink = /**
     * @param {?} activeLink
     * @return {?}
     */
    function (activeLink) {
        if (activeLink) {
            activeLink.active = true;
            activeLink.detectChanges();
            this.activeSubject.next(activeLink);
        }
    };
    /**
     * @param {?} scrollSpyId
     * @return {?}
     */
    ScrollSpyService.prototype.removeActiveLinks = /**
     * @param {?} scrollSpyId
     * @return {?}
     */
    function (scrollSpyId) {
        /** @type {?} */
        var scrollSpy = this.scrollSpys.find((/**
         * @param {?} spy
         * @return {?}
         */
        function (spy) {
            return spy.id === scrollSpyId;
        }));
        if (!scrollSpy) {
            return;
        }
        scrollSpy.links.forEach((/**
         * @param {?} link
         * @return {?}
         */
        function (link) {
            link.active = false;
            link.detectChanges();
        }));
    };
ScrollSpyService.ɵfac = function ScrollSpyService_Factory(t) { return new (t || ScrollSpyService)(); };
ScrollSpyService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: ScrollSpyService, factory: function (t) { return ScrollSpyService.ɵfac(t); } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ScrollSpyService, [{
        type: Injectable
    }], function () { return []; }, null); })();
    return ScrollSpyService;
}());
export { ScrollSpyService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ScrollSpyService.prototype.scrollSpys;
    /**
     * @type {?}
     * @private
     */
    ScrollSpyService.prototype.activeSubject;
    /** @type {?} */
    ScrollSpyService.prototype.active$;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2Nyb2xsLXNweS5zZXJ2aWNlLmpzIiwic291cmNlcyI6WyJuZy11aWtpdC1wcm8tc3RhbmRhcmQvbGliL3Byby9zY3JvbGwtc3B5L3Njcm9sbC1zcHkuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBYSxNQUFNLGVBQWUsQ0FBQztBQUV0RCxPQUFPLEVBQUUsT0FBTyxFQUFjLE1BQU0sTUFBTSxDQUFDO0FBQzNDO0FBQ0c7QUFBVzs7QUFBZCwrQkFHQztBQUNEO0FBQ1k7QUFDTyxJQUxqQix1QkFBVztBQUNiO0FBQXFCLElBQW5CLDBCQUF5QztBQUMzQztBQUVBO0FBRU0sSUFGTjtBQUNnQixRQUNOLGVBQVUsR0FBZ0IsRUFBRSxDQUFDO0FBQ3ZDLFFBQ1Usa0JBQWEsR0FBRyxJQUFJLE9BQU8sRUFBMEIsQ0FBQztBQUNoRSxRQUFFLFlBQU8sR0FBb0IsSUFBSSxDQUFDLGFBQWEsQ0FBQztBQUNoRCxJQXVFQSxDQUFDO0FBQ0Q7QUFBUTtBQUE0QjtBQUFtQjtBQUFRLElBdkU3RCx1Q0FBWTtBQUFPO0FBQ1g7QUFBbUI7QUFDN0IsSUFGRSxVQUFhLFNBQW9CO0FBQ25DLFFBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDcEMsSUFBRSxDQUFDO0FBRUg7QUFBUTtBQUE4QjtBQUN0QjtBQUFRLElBRHRCLDBDQUFlO0FBQU87QUFDWDtBQUFtQjtBQUFRLElBRHRDLFVBQWdCLFdBQW1CO0FBQ3JDO0FBQXlCLFlBQWYsY0FBYyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUztBQUFNO0FBQ3ZDO0FBQ2Q7QUFDSSxRQUg2QyxVQUFDLEdBQUc7QUFBSSxZQUN4RCxPQUFPLEdBQUcsQ0FBQyxFQUFFLEtBQUssV0FBVyxDQUFDO0FBQ3BDLFFBQUksQ0FBQyxFQUFDO0FBQ04sUUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FB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QUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBNUVBLEFBQUEsQUE2RUEsQUFBQSxBQUFBLEFBN0VBLEFBNkVBLEFBNUVBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBRdWVyeUxpc3QgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFNjcm9sbFNweUxpbmtEaXJlY3RpdmUgfSBmcm9tICcuL3Njcm9sbC1zcHktbGluay5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgU3ViamVjdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjcm9sbFNweSB7XG4gIGlkOiBzdHJpbmc7XG4gIGxpbmtzOiBRdWVyeUxpc3Q8U2Nyb2xsU3B5TGlua0RpcmVjdGl2ZT47XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBTY3JvbGxTcHlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzY3JvbGxTcHlzOiBTY3JvbGxTcHlbXSA9IFtdO1xuXG4gIHByaXZhdGUgYWN0aXZlU3ViamVjdCA9IG5ldyBTdWJqZWN0PFNjcm9sbFNweUxpbmtEaXJlY3RpdmU+KCk7XG4gIGFjdGl2ZSQ6IE9ic2VydmFibGU8YW55PiA9IHRoaXMuYWN0aXZlU3ViamVjdDtcblxuICBhZGRTY3JvbGxTcHkoc2Nyb2xsU3B5OiBTY3JvbGxTcHkpIHtcbiAgICB0aGlzLnNjcm9sbFNweXMucHVzaChzY3JvbGxTcHkpO1xuICB9XG5cbiAgcmVtb3ZlU2Nyb2xsU3B5KHNjcm9sbFNweUlkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzY3JvbGxTcHlJbmRleCA9IHRoaXMuc2Nyb2xsU3B5cy5maW5kSW5kZXgoIChzcHkpID0+IHtcbiAgICAgIHJldHVybiBzcHkuaWQgPT09IHNjcm9sbFNweUlkO1xuICAgIH0pO1xuICAgIHRoaXMuc2Nyb2xsU3B5cy5zcGxpY2Uoc2Nyb2xsU3B5SW5kZXgsIDEpO1xuICB9XG5cbiAgdXBkYXRlQWN0aXZlU3RhdGUoc2Nyb2xsU3B5SWQ6IHN0cmluZywgYWN0aXZlTGlua0lkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzY3JvbGxTcHkgPSB0aGlzLnNjcm9sbFNweXMuZmluZChzcHkgPT4ge1xuICAgICAgcmV0dXJuIHNweS5pZCA9PT0gc2Nyb2xsU3B5SWQ7XG4gICAgfSk7XG5cbiAgICBpZiAoIXNjcm9sbFNweSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGl2ZUxpbmsgPSBzY3JvbGxTcHkubGlua3MuZmluZChsaW5rID0+IHtcbiAgICAgIHJldHVybiBsaW5rLmlkID09PSBhY3RpdmVMaW5rSWQ7XG4gICAgfSk7XG5cbiAgICB0aGlzLnNldEFjdGl2ZUxpbmsoYWN0aXZlTGluayk7XG4gIH1cblxuICByZW1vdmVBY3RpdmVTdGF0ZShzY3JvbGxTcHlJZDogc3RyaW5nLCBhY3RpdmVMaW5rSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNjcm9sbFNweSA9IHRoaXMuc2Nyb2xsU3B5cy5maW5kKHNweSA9PiB7XG4gICAgICByZXR1cm4gc3B5LmlkID09PSBzY3JvbGxTcHlJZDtcbiAgICB9KTtcblxuICAgIGlmICghc2Nyb2xsU3B5KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYWN0aXZlTGluayA9IHNjcm9sbFNweS5saW5rcy5maW5kKGxpbmsgPT4ge1xuICAgICAgcmV0dXJuIGxpbmsuaWQgPT09IGFjdGl2ZUxpbmtJZDtcbiAgICB9KTtcblxuICAgIGlmICghYWN0aXZlTGluaykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGFjdGl2ZUxpbmsuYWN0aXZlID0gZmFsc2U7XG4gICAgYWN0aXZlTGluay5kZXRlY3RDaGFuZ2VzKCk7XG4gIH1cblxuICBzZXRBY3RpdmVMaW5rKGFjdGl2ZUxpbms6IFNjcm9sbFNweUxpbmtEaXJlY3RpdmUgfCBhbnkpIHtcbiAgICBpZiAoYWN0aXZlTGluaykge1xuICAgICAgYWN0aXZlTGluay5hY3RpdmUgPSB0cnVlO1xuICAgICAgYWN0aXZlTGluay5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICB0aGlzLmFjdGl2ZVN1YmplY3QubmV4dChhY3RpdmVMaW5rKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVBY3RpdmVMaW5rcyhzY3JvbGxTcHlJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Nyb2xsU3B5OiBTY3JvbGxTcHkgfCB1bmRlZmluZWQgPSB0aGlzLnNjcm9sbFNweXMuZmluZChzcHkgPT4ge1xuICAgICAgcmV0dXJuIHNweS5pZCA9PT0gc2Nyb2xsU3B5SWQ7XG4gICAgfSk7XG5cbiAgICBpZiAoIXNjcm9sbFNweSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNjcm9sbFNweS5saW5rcy5mb3JFYWNoKGxpbmsgPT4ge1xuICAgICAgbGluay5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIGxpbmsuZGV0ZWN0Q2hhbmdlcygpO1xuICAgIH0pO1xuICB9XG59XG4iXX0=