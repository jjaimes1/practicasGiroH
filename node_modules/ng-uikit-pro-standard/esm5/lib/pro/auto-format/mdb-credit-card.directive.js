/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Directive, HostListener, Input, HostBinding } from '@angular/core';
/**
 * @record
 */
import * as ɵngcc0 from '@angular/core';
export function CreditCard() { }
if (false) {
    /** @type {?} */
    CreditCard.prototype.name;
    /** @type {?} */
    CreditCard.prototype.fullName;
    /** @type {?} */
    CreditCard.prototype.re;
    /** @type {?} */
    CreditCard.prototype.pattern;
    /** @type {?} */
    CreditCard.prototype.maxLength;
    /** @type {?} */
    CreditCard.prototype.cvvLength;
}
var MdbCreditCardDirective = /** @class */ (function () {
    function MdbCreditCardDirective() {
        this.standardPattern = /(\d{1,4})/g;
        this.defaultCard = {
            name: '',
            fullName: '',
            re: /\d{0,16}/,
            pattern: this.standardPattern,
            maxLength: 19,
            cvvLength: 3,
        };
        this.cards = [
            {
                name: 'visa',
                fullName: 'Visa',
                re: /^4\d{0,15}/,
                pattern: this.standardPattern,
                maxLength: 16,
                cvvLength: 3,
            },
            {
                name: 'mastercard',
                fullName: 'Mastercard',
                re: /^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,
                pattern: this.standardPattern,
                maxLength: 16,
                cvvLength: 3,
            },
            {
                name: 'amex',
                fullName: 'American Express',
                re: /^3[47]\d{0,13}/,
                pattern: /(\d{1,4})(\d{1,6})?(\d{1,5})?/,
                maxLength: 15,
                cvvLength: 4,
            },
            {
                name: 'jcb',
                fullName: 'JCB',
                re: /^(?:35\d{0,2})\d{0,12}/,
                pattern: this.standardPattern,
                maxLength: 16,
                cvvLength: 3,
            },
            {
                name: 'discover',
                fullName: 'Discover',
                re: /^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,
                pattern: this.standardPattern,
                maxLength: 16,
                cvvLength: 3,
            },
            {
                name: 'diners-club',
                fullName: 'Diners Club',
                re: /^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,
                pattern: this.standardPattern,
                maxLength: 14,
                cvvLength: 3,
            },
        ];
        this._separator = ' ';
    }
    Object.defineProperty(MdbCreditCardDirective.prototype, "additionalCards", {
        get: /**
         * @return {?}
         */
        function () {
            return this._additionalCards;
        },
        set: /**
         * @param {?} cards
         * @return {?}
         */
        function (cards) {
            this._additionalCards = cards;
            this.addCards(cards);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MdbCreditCardDirective.prototype, "separator", {
        get: /**
         * @return {?}
         */
        function () {
            return this._separator;
        },
        set: /**
         * @param {?} separator
         * @return {?}
         */
        function (separator) {
            this._separator = separator;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} event
     * @return {?}
     */
    MdbCreditCardDirective.prototype.onInput = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.formatInput(event);
    };
    /**
     * @private
     * @param {?} event
     * @return {?}
     */
    MdbCreditCardDirective.prototype.formatInput = /**
     * @private
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var input = event.target.value;
        /** @type {?} */
        var formattedInput = this.getFormattedInput(input);
        event.target.value = formattedInput;
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    MdbCreditCardDirective.prototype.getFormattedInput = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        value = this.removeNonDigits(value);
        /** @type {?} */
        var card = this.findCardByNumber(value);
        this.updateCurrentCardNames(card.name, card.fullName);
        /** @type {?} */
        var cardNumMaxLength;
        if (this.hasStandardPattern(card)) {
            /** @type {?} */
            var matches = value.match(card.pattern);
            if (matches === null) {
                return value;
            }
            cardNumMaxLength = card.maxLength + matches.length - 1;
            this.maxLength = cardNumMaxLength.toString();
            return matches.join(this.separator);
        }
        else {
            /** @type {?} */
            var results = card.pattern.exec(value);
            if (results === null) {
                return value;
            }
            results.shift();
            cardNumMaxLength = card.maxLength + results.length - 1;
            this.maxLength = cardNumMaxLength.toString();
            return results.filter(this.isMatch).join(this.separator);
        }
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    MdbCreditCardDirective.prototype.removeNonDigits = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        return value.replace(/\D/g, '');
    };
    /**
     * @private
     * @param {?} card
     * @return {?}
     */
    MdbCreditCardDirective.prototype.hasStandardPattern = /**
     * @private
     * @param {?} card
     * @return {?}
     */
    function (card) {
        return card.pattern.toString() === this.standardPattern.toString();
    };
    /**
     * @private
     * @param {?} match
     * @return {?}
     */
    MdbCreditCardDirective.prototype.isMatch = /**
     * @private
     * @param {?} match
     * @return {?}
     */
    function (match) {
        return match !== undefined;
    };
    /**
     * @private
     * @param {?} name
     * @param {?} fullName
     * @return {?}
     */
    MdbCreditCardDirective.prototype.updateCurrentCardNames = /**
     * @private
     * @param {?} name
     * @param {?} fullName
     * @return {?}
     */
    function (name, fullName) {
        this.cardName = name;
        this.cardFullName = fullName;
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    MdbCreditCardDirective.prototype.findCardByNumber = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        /** @type {?} */
        var cardType = this.cards.find((/**
         * @param {?} card
         * @return {?}
         */
        function (card) {
            return card.re.test(value);
        }));
        if (!cardType) {
            return this.defaultCard;
        }
        return cardType;
    };
    /**
     * @param {?} newCards
     * @return {?}
     */
    MdbCreditCardDirective.prototype.addCards = /**
     * @param {?} newCards
     * @return {?}
     */
    function (newCards) {
        var _this = this;
        newCards.forEach((/**
         * @param {?} card
         * @return {?}
         */
        function (card) {
            _this.cards.push(card);
        }));
    };
    /** @nocollapse */
    MdbCreditCardDirective.ctorParameters = function () { return []; };
    MdbCreditCardDirective.propDecorators = {
        additionalCards: [{ type: Input }],
        separator: [{ type: Input }],
        maxLength: [{ type: HostBinding, args: ['attr.maxLength',] }],
        onInput: [{ type: HostListener, args: ['input', ['$event'],] }]
    };
MdbCreditCardDirective.ɵfac = function MdbCreditCardDirective_Factory(t) { return new (t || MdbCreditCardDirective)(); };
MdbCreditCardDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MdbCreditCardDirective, selectors: [["", "mdbCreditCard", ""]], hostVars: 1, hostBindings: function MdbCreditCardDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("input", function MdbCreditCardDirective_input_HostBindingHandler($event) { return ctx.onInput($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("maxLength", ctx.maxLength);
    } }, inputs: { additionalCards: "additionalCards", separator: "separator" }, exportAs: ["mdbCreditCard"] });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MdbCreditCardDirective, [{
        type: Directive,
        args: [{
                selector: '[mdbCreditCard]',
                exportAs: 'mdbCreditCard'
            }]
    }], function () { return []; }, { additionalCards: [{
            type: Input
        }], separator: [{
            type: Input
        }], onInput: [{
            type: HostListener,
            args: ['input', ['$event']]
        }], maxLength: [{
            type: HostBinding,
            args: ['attr.maxLength']
        }] }); })();
    return MdbCreditCardDirective;
}());
export { MdbCreditCardDirective };
if (false) {
    /**
     * @type {?}
     * @private
     */
    MdbCreditCardDirective.prototype.standardPattern;
    /** @type {?} */
    MdbCreditCardDirective.prototype.cardName;
    /** @type {?} */
    MdbCreditCardDirective.prototype.cardFullName;
    /**
     * @type {?}
     * @private
     */
    MdbCreditCardDirective.prototype.defaultCard;
    /**
     * @type {?}
     * @private
     */
    MdbCreditCardDirective.prototype.cards;
    /**
     * @type {?}
     * @private
     */
    MdbCreditCardDirective.prototype._additionalCards;
    /**
     * @type {?}
     * @private
     */
    MdbCreditCardDirective.prototype._separator;
    /** @type {?} */
    MdbCreditCardDirective.prototype.maxLength;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWRiLWNyZWRpdC1jYXJkLmRpcmVjdGl2ZS5qcyIsInNvdXJjZXMiOlsibmctdWlraXQtcHJvLXN0YW5kYXJkL2xpYi9wcm8vYXV0by1mb3JtYXQvbWRiLWNyZWRpdC1jYXJkLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM1RTtBQUNHO0FBQVc7O0FBQWQsZ0NBT0M7QUFDRDtBQUNZO0FBQ1EsSUFUbEIsMEJBQWE7QUFDZjtBQUNDLElBREMsOEJBQWlCO0FBQ25CO0FBQ08sSUFETCx3QkFBVztBQUNiO0FBQ0UsSUFEQSw2QkFBZ0I7QUFDbEI7QUFDQSxJQURFLCtCQUFrQjtBQUNwQjtBQUNBLElBREUsK0JBQWtCO0FBQ3BCO0FBRUE7QUFFYyxJQXNGWjtBQUVnQixRQXJGUixvQkFBZSxHQUFHLFlBQVksQ0FBQztBQUN6QyxRQUdVLGdCQUFXLEdBQWU7QUFDcEMsWUFBSSxJQUFJLEVBQUUsRUFBRTtBQUNaLFlBQUksUUFBUSxFQUFFLEVBQUU7QUFDaEIsWUFBSSxFQUFFLEVBQUUsVUFBVTtBQUNsQixZQUFJLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZTtBQUNqQyxZQUFJLFNBQVMsRUFBRSxFQUFFO0FBQ2pCLFlBQUksU0FBUyxFQUFFLENBQUM7QUFDaEIsU0FBRyxDQUFDO0FBQ0osUUFDVSxVQUFLLEdBQWlCO0FBQ2hDLFlBQUk7QUFDSixnQkFBTSxJQUFJLEVBQUUsTUFBTTtBQUNsQixnQkFBTSxRQUFRLEVBQUUsTUFBTTtBQUN0QixnQkFBTSxFQUFFLEVBQUUsWUFBWTtBQUN0QixnQkFBTSxPQUFPLEVBQUUsSUFBSSxDQUFDLGVBQWU7QUFDbkMsZ0JBQU0sU0FBUyxFQUFFLEVBQUU7QUFDbkIsZ0JBQU0sU0FBUyxFQUFFLENBQUM7QUFDbEIsYUFBSztBQUNMLFlBQUk7QUFDSixnQkFBTSxJQUFJLEVBQUUsWUFBWTtBQUN4QixnQkFBTSxRQUFRLEVBQUUsWUFBWTtBQUM1QixnQkFBTSxFQUFFLEVBQUUsdURBQXVEO0FBQ2pFLGdCQUFNLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZTtBQUNuQyxnQkFBTSxTQUFTLEVBQUUsRUFBRTtBQUNuQixnQkFBTSxTQUFTLEVBQUUsQ0FBQztBQUNsQixhQUFLO0FBQ0wsWUFBSTtBQUNKLGdCQUFNLElBQUksRUFBRSxNQUFNO0FBQ2xCLGdCQUFNLFFBQVEsRUFBRSxrQkFBa0I7QUFDbEMsZ0JBQU0sRUFBRSxFQUFFLGdCQUFnQjtBQUMxQixnQkFBTSxPQUFPLEVBQUUsK0JBQStCO0FBQzlDLGdCQUFNLFNBQVMsRUFBRSxFQUFFO0FBQ25CLGdCQUFNLFNBQVMsRUFBRSxDQUFDO0FBQ2xCLGFBQUs7QUFDTCxZQUFJO0FBQ0osZ0JBQU0sSUFBSSxFQUFFLEtBQUs7QUFDakIsZ0JBQU0sUUFBUSxFQUFFLEtBQUs7QUFDckIsZ0JBQU0sRUFBRSxFQUFFLHdCQUF3QjtBQUNsQyxnQkFBTSxPQUFPLEVBQUUsSUFBSSxDQUFDLGVBQWU7QUFDbkMsZ0JBQU0sU0FBUyxFQUFFLEVBQUU7QUFDbkIsZ0JBQU0sU0FBUyxFQUFFLENBQUM7QUFDbEIsYUFBSztBQUNMLFlBQUk7QUFDSixnQkFBTSxJQUFJLEVBQUUsVUFBVTtBQUN0QixnQkFBTSxRQUFRLEVBQUUsVUFBVTtBQUMxQixnQkFBTSxFQUFFLEVBQUUsd0NBQXdDO0FBQ2xELGdCQUFNLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZTtBQUNuQyxnQkFBTSxTQUFTLEVBQUUsRUFBRTtBQUNuQixnQkFBTSxTQUFTLEVBQUUsQ0FBQztBQUNsQixhQUFLO0FBQ0wsWUFBSTtBQUNKLGdCQUFNLElBQUksRUFBRSxhQUFhO0FBQ3pCLGdCQUFNLFFBQVEsRUFBRSxhQUFhO0FBQzdCLGdCQUFNLEVBQUUsRUFBRSxtQ0FBbUM7QUFDN0MsZ0JBQU0sT0FBTyxFQUFFLElBQUksQ0FBQyxlQUFlO0FBQ25DLGdCQUFNLFNBQVMsRUFBRSxFQUFFO0FBQ25CLGdCQUFNLFNBQVMsRUFBRSxDQUFDO0FBQ2xCLGFBQUs7QUFDTCxTQUFHLENBQUM7QUFDSixRQWtCVSxlQUFVLEdBQUcsR0FBRyxDQUFDO0FBQzNCLElBQ2lCLENBQUM7QUFDbEIsSUFwQkUsc0JBQ0ksbURBQWU7QUFBSTtBQUNUO0FBRWY7QUFBWSxRQUpYO0FBQ0csWUFDRCxPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQztBQUNqQyxRQUFFLENBQUM7QUFDRjtBQUFpQjtBQUNqQjtBQUF1QjtBQUN2QixRQUZDLFVBQW9CLEtBQW1CO0FBQ3pDLFlBQUksSUFBSSxDQUFDLGdCQUFnQixHQUFHLEtBQUssQ0FBQztBQUNsQyxZQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDekIsUUFBRSxDQUFDO0FBQ0Y7QUFBMEI7QUFHM0IsT0FSRztBQUNILElBTUUsc0JBQ0ksNkNBQVM7QUFBSTtBQUNIO0FBRVQ7QUFBWSxRQUpqQjtBQUNHLFlBQ0QsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0FBQzNCLFFBQUUsQ0FBQztBQUNGO0FBQWlCO0FBQ0w7QUFDVjtBQUNRLFFBSFQsVUFBYyxTQUFpQjtBQUNqQyxZQUFJLElBQUksQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDO0FBQ2hDLFFBQUUsQ0FBQztBQUNGO0FBQTBCO0FBSXRCLE9BUkY7QUFDSDtBQUFRO0FBQXdCO0FBQ2xCO0FBQVEsSUFTcEIsd0NBQU87QUFBTztBQUNBO0FBR2Y7QUFBUSxJQUxQLFVBQ1EsS0FBVTtBQUNwQixRQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDNUIsSUFBRSxDQUFDO0FBRUg7QUFBUTtBQUFnQjtBQUNaO0FBQW1CO0FBQzlCLElBRlMsNENBQVc7QUFBTztBQUNwQjtBQUF3QjtBQUNuQjtBQUFRLElBRm5CLFVBQW9CLEtBQVU7QUFDaEM7QUFBeUIsWUFBZixLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLO0FBQ3BDO0FBQXlCLFlBQWYsY0FBYyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUM7QUFDeEQsUUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxjQUFjLENBQUM7QUFDeEMsSUFBRSxDQUFDO0FBRUg7QUFBUTtBQUFnQjtBQUNyQjtBQUFtQjtBQUFRLElBRHBCLGtEQUFpQjtBQUFPO0FBQzdCO0FBQXdCO0FBQ3RCO0FBQVEsSUFGYixVQUEwQixLQUFhO0FBQ3pDLFFBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDeEM7QUFBeUIsWUFBZixJQUFJLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQztBQUM3QyxRQUNJLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUMxRDtBQUN3QixZQUFoQixnQkFBd0I7QUFDaEMsUUFDSSxJQUFJLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsRUFBRTtBQUN2QztBQUE2QixnQkFBakIsT0FBTyxHQUE0QixLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUM7QUFDeEUsWUFDTSxJQUFJLE9BQU8sS0FBSyxJQUFJLEVBQUU7QUFDNUIsZ0JBQVEsT0FBTyxLQUFLLENBQUM7QUFDckIsYUFBTztBQUNQLFlBQ00sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLFNBQVMsR0FBRyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztBQUM3RCxZQUFNLElBQUksQ0FBQyxTQUFTLEdBQUcsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDbkQsWUFBTSxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzFDLFNBQUs7QUFBQyxhQUFLO0FBQ1g7QUFBNkIsZ0JBQWpCLE9BQU8sR0FBMkIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBQ3RFLFlBQ00sSUFBSSxPQUFPLEtBQUssSUFBSSxFQUFFO0FBQzVCLGdCQUFRLE9BQU8sS0FBSyxDQUFDO0FBQ3JCLGFBQU87QUFDUCxZQUFNLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUN0QixZQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDN0QsWUFBTSxJQUFJLENBQUMsU0FBUyxHQUFHLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQ25ELFlBQU0sT0FBTyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQy9ELFNBQUs7QUFDTCxJQUFFLENBQUM7QUFFSDtBQUFRO0FBQWdCO0FBQ25CO0FBQW1CO0FBQVEsSUFEdEIsZ0RBQWU7QUFBTztBQUMzQjtBQUF3QjtBQUd2QjtBQUFRLElBSlosVUFBd0IsS0FBYTtBQUN2QyxRQUFJLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDcEMsSUFBRSxDQUFDO0FBRUg7QUFBUTtBQUFnQjtBQUF1QjtBQUM5QjtBQUFRLElBRGYsbURBQWtCO0FBQU87QUFDakM7QUFBdUI7QUFBbUI7QUFBUSxJQURsRCxVQUEyQixJQUFnQjtBQUM3QyxRQUFJLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsS0FBSyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsRUFBRSxDQUFDO0FBQ3ZFLElBQUUsQ0FBQztBQUVIO0FBQVE7QUFBZ0I7QUFDWDtBQUNiO0FBRUcsSUFKTyx3Q0FBTztBQUFPO0FBQ25CO0FBQXdCO0FBR2xCO0FBQVEsSUFKakIsVUFBZ0IsS0FBYTtBQUMvQixRQUFJLE9BQU8sS0FBSyxLQUFLLFNBQVMsQ0FBQztBQUMvQixJQUFFLENBQUM7QUFFSDtBQUFRO0FBQWdCO0FBQXVCO0FBQ3hDO0FBQ1A7QUFBUSxJQUZFLHVEQUFzQjtBQUFPO0FBQWdCO0FBQzVDO0FBQ0M7QUFBbUI7QUFHL0IsSUFMRSxVQUErQixJQUFZLEVBQUUsUUFBZ0I7QUFDL0QsUUFBSSxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztBQUN6QixRQUFJLElBQUksQ0FBQyxZQUFZLEdBQUcsUUFBUSxDQUFDO0FBQ2pDLElBQUUsQ0FBQztBQUVIO0FBQVE7QUFBZ0I7QUFDcEI7QUFBbUI7QUFBUSxJQURyQixpREFBZ0I7QUFBTztBQUM1QjtBQUF3QjtBQUM1QjtBQUFRLElBRlAsVUFBeUIsS0FBYTtBQUN4QztBQUF5QixZQUFmLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUk7QUFBTTtBQUNwQjtBQUdwQjtBQUFZLFFBSnVCLFVBQUEsSUFBSTtBQUFJLFlBQ3ZDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDakMsUUFBSSxDQUFDLEVBQUM7QUFDTixRQUNJLElBQUksQ0FBQyxRQUFRLEVBQUU7QUFDbkIsWUFBTSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7QUFDOUIsU0FBSztBQUNMLFFBQ0ksT0FBTyxRQUFRLENBQUM7QUFDcEIsSUFBRSxDQUFDO0FBRUg7QUFBUTtBQUEyQjtBQUN6QjtBQUFRLElBRFQseUNBQVE7QUFBTztBQUNqQjtBQUFtQjtBQUN2QixJQUZELFVBQWdCLFFBQXNCO0FBQ3hDLFFBREUsaUJBSUM7QUFDSCxRQUpJLFFBQVEsQ0FBQyxPQUFPO0FBQU07QUFDSjtBQUlwQjtBQUFZLFFBTE8sVUFBQSxJQUFJO0FBQUksWUFDdkIsS0FBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDNUIsUUFBSSxDQUFDLEVBQUMsQ0FBQztBQUNQLElBQUUsQ0FBQyxDQW5LTTtBQUFDO21DQUpULFNBQVMsU0FBQyxyREFJc0I7R0FIL0IsUUFBUSxFQUFFLGlCQUFpQiw5QkFNeEI7TUFMSCxRQUFRLEVBQUUsZUFBZSwvQkFPRCxrQ0E0RHZCLEtBQUs7TUFsRVAsTkFtRUMsNEJBU0MsS0FBSztBQUNOLDRCQVVDLFdBQVcsU0FBQyxnQkFBZ0I7QUFBTywwQkFFbkMsWUFBWSxTQUFDLE9BQU8sRUFBRSxDQUFDLFFBQVEsQ0FBQztBQUMvQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQU07QUFBQyxJQTJFWCw2QkFBQztBQUNBLENBREEsQUF4S0QsSUF3S0M7QUFDRCxTQXJLYSxzQkFBc0I7QUFDbEM7QUFBYTtBQUFRO0FBQWlCO0FBQzFCO0FBQ1osSUFGQyxpREFBdUM7QUFDekM7QUFDQyxJQURDLDBDQUFpQjtBQUNuQjtBQUFxQixJQUFuQiw4Q0FBcUI7QUFDdkI7QUFDTztBQUFpQjtBQUN0QjtBQUFRLElBRFIsNkNBT0U7QUFDSjtBQUNPO0FBQWlCO0FBRXhCO0FBQVEsSUFGTix1Q0FpREU7QUFDSjtBQUNPO0FBQ007QUFDVjtBQUFRLElBTVQsa0RBQXVDO0FBQ3pDO0FBQ087QUFDTTtBQUNKO0FBQVEsSUFLZiw0Q0FBeUI7QUFDM0I7QUFHQSxJQUFFLDJDQUFpRDs7QUFyR0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBT0EsQUFOQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFHQSxBQXdGQSxBQW5GQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBSUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFtQkEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFuQkEsQUFDQSxBQUFBLEFBREEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUpBLEFBT0EsQUFDQSxBQUFBLEFBREEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBSEEsQUFXQSxBQUFBLEFBREEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUlBLEFBSEEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQXZLQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFrRUEsQUFBQSxBQVVBLEFBQUEsQUFXQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUE0RUEsQUFBQSxBQUFBLEFBeEtBLEFBd0tBLEFBcEtBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQU9BLEFBRUEsQUFpREEsQUFVQSxBQUFBLEFBU0EsQUFBQSxBQUlBLEFBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIEhvc3RMaXN0ZW5lciwgSW5wdXQsIEhvc3RCaW5kaW5nIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlZGl0Q2FyZCB7XG4gIG5hbWU6IHN0cmluZztcbiAgZnVsbE5hbWU6IHN0cmluZztcbiAgcmU6IFJlZ0V4cDtcbiAgcGF0dGVybjogUmVnRXhwO1xuICBtYXhMZW5ndGg6IG51bWJlcjtcbiAgY3Z2TGVuZ3RoOiBudW1iZXI7XG59XG5cbkBEaXJlY3RpdmUoe1xuICBzZWxlY3RvcjogJ1ttZGJDcmVkaXRDYXJkXScsXG4gIGV4cG9ydEFzOiAnbWRiQ3JlZGl0Q2FyZCcsXG59KVxuZXhwb3J0IGNsYXNzIE1kYkNyZWRpdENhcmREaXJlY3RpdmUge1xuICBwcml2YXRlIHN0YW5kYXJkUGF0dGVybiA9IC8oXFxkezEsNH0pL2c7XG4gIGNhcmROYW1lOiBzdHJpbmc7XG4gIGNhcmRGdWxsTmFtZTogc3RyaW5nO1xuXG4gIHByaXZhdGUgZGVmYXVsdENhcmQ6IENyZWRpdENhcmQgPSB7XG4gICAgbmFtZTogJycsXG4gICAgZnVsbE5hbWU6ICcnLFxuICAgIHJlOiAvXFxkezAsMTZ9LyxcbiAgICBwYXR0ZXJuOiB0aGlzLnN0YW5kYXJkUGF0dGVybixcbiAgICBtYXhMZW5ndGg6IDE5LFxuICAgIGN2dkxlbmd0aDogMyxcbiAgfTtcblxuICBwcml2YXRlIGNhcmRzOiBDcmVkaXRDYXJkW10gPSBbXG4gICAge1xuICAgICAgbmFtZTogJ3Zpc2EnLFxuICAgICAgZnVsbE5hbWU6ICdWaXNhJyxcbiAgICAgIHJlOiAvXjRcXGR7MCwxNX0vLFxuICAgICAgcGF0dGVybjogdGhpcy5zdGFuZGFyZFBhdHRlcm4sXG4gICAgICBtYXhMZW5ndGg6IDE2LFxuICAgICAgY3Z2TGVuZ3RoOiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ21hc3RlcmNhcmQnLFxuICAgICAgZnVsbE5hbWU6ICdNYXN0ZXJjYXJkJyxcbiAgICAgIHJlOiAvXig1WzEtNV1cXGR7MCwyfXwyMlsyLTldXFxkezAsMX18MlszLTddXFxkezAsMn0pXFxkezAsMTJ9LyxcbiAgICAgIHBhdHRlcm46IHRoaXMuc3RhbmRhcmRQYXR0ZXJuLFxuICAgICAgbWF4TGVuZ3RoOiAxNixcbiAgICAgIGN2dkxlbmd0aDogMyxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdhbWV4JyxcbiAgICAgIGZ1bGxOYW1lOiAnQW1lcmljYW4gRXhwcmVzcycsXG4gICAgICByZTogL14zWzQ3XVxcZHswLDEzfS8sXG4gICAgICBwYXR0ZXJuOiAvKFxcZHsxLDR9KShcXGR7MSw2fSk/KFxcZHsxLDV9KT8vLFxuICAgICAgbWF4TGVuZ3RoOiAxNSxcbiAgICAgIGN2dkxlbmd0aDogNCxcbiAgICB9LFxuICAgIHtcbiAgICAgIG5hbWU6ICdqY2InLFxuICAgICAgZnVsbE5hbWU6ICdKQ0InLFxuICAgICAgcmU6IC9eKD86MzVcXGR7MCwyfSlcXGR7MCwxMn0vLFxuICAgICAgcGF0dGVybjogdGhpcy5zdGFuZGFyZFBhdHRlcm4sXG4gICAgICBtYXhMZW5ndGg6IDE2LFxuICAgICAgY3Z2TGVuZ3RoOiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgbmFtZTogJ2Rpc2NvdmVyJyxcbiAgICAgIGZ1bGxOYW1lOiAnRGlzY292ZXInLFxuICAgICAgcmU6IC9eKD86NjAxMXw2NVxcZHswLDJ9fDY0WzQtOV1cXGQ/KVxcZHswLDEyfS8sXG4gICAgICBwYXR0ZXJuOiB0aGlzLnN0YW5kYXJkUGF0dGVybixcbiAgICAgIG1heExlbmd0aDogMTYsXG4gICAgICBjdnZMZW5ndGg6IDMsXG4gICAgfSxcbiAgICB7XG4gICAgICBuYW1lOiAnZGluZXJzLWNsdWInLFxuICAgICAgZnVsbE5hbWU6ICdEaW5lcnMgQ2x1YicsXG4gICAgICByZTogL14zKD86MChbMC01XXw5KXxbNjg5XVxcZD8pXFxkezAsMTF9LyxcbiAgICAgIHBhdHRlcm46IHRoaXMuc3RhbmRhcmRQYXR0ZXJuLFxuICAgICAgbWF4TGVuZ3RoOiAxNCxcbiAgICAgIGN2dkxlbmd0aDogMyxcbiAgICB9LFxuICBdO1xuXG4gIEBJbnB1dCgpXG4gIGdldCBhZGRpdGlvbmFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2FkZGl0aW9uYWxDYXJkcztcbiAgfVxuICBzZXQgYWRkaXRpb25hbENhcmRzKGNhcmRzOiBDcmVkaXRDYXJkW10pIHtcbiAgICB0aGlzLl9hZGRpdGlvbmFsQ2FyZHMgPSBjYXJkcztcbiAgICB0aGlzLmFkZENhcmRzKGNhcmRzKTtcbiAgfVxuICBwcml2YXRlIF9hZGRpdGlvbmFsQ2FyZHM6IENyZWRpdENhcmRbXTtcblxuICBASW5wdXQoKVxuICBnZXQgc2VwYXJhdG9yKCkge1xuICAgIHJldHVybiB0aGlzLl9zZXBhcmF0b3I7XG4gIH1cbiAgc2V0IHNlcGFyYXRvcihzZXBhcmF0b3I6IHN0cmluZykge1xuICAgIHRoaXMuX3NlcGFyYXRvciA9IHNlcGFyYXRvcjtcbiAgfVxuICBwcml2YXRlIF9zZXBhcmF0b3IgPSAnICc7XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIEBIb3N0QmluZGluZygnYXR0ci5tYXhMZW5ndGgnKSBtYXhMZW5ndGg6IHN0cmluZztcblxuICBASG9zdExpc3RlbmVyKCdpbnB1dCcsIFsnJGV2ZW50J10pXG4gIG9uSW5wdXQoZXZlbnQ6IGFueSkge1xuICAgIHRoaXMuZm9ybWF0SW5wdXQoZXZlbnQpO1xuICB9XG5cbiAgcHJpdmF0ZSBmb3JtYXRJbnB1dChldmVudDogYW55KSB7XG4gICAgY29uc3QgaW5wdXQgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgY29uc3QgZm9ybWF0dGVkSW5wdXQgPSB0aGlzLmdldEZvcm1hdHRlZElucHV0KGlucHV0KTtcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSBmb3JtYXR0ZWRJbnB1dDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Rm9ybWF0dGVkSW5wdXQodmFsdWU6IHN0cmluZykge1xuICAgIHZhbHVlID0gdGhpcy5yZW1vdmVOb25EaWdpdHModmFsdWUpO1xuICAgIGNvbnN0IGNhcmQgPSB0aGlzLmZpbmRDYXJkQnlOdW1iZXIodmFsdWUpO1xuXG4gICAgdGhpcy51cGRhdGVDdXJyZW50Q2FyZE5hbWVzKGNhcmQubmFtZSwgY2FyZC5mdWxsTmFtZSk7XG5cbiAgICBsZXQgY2FyZE51bU1heExlbmd0aDogbnVtYmVyO1xuXG4gICAgaWYgKHRoaXMuaGFzU3RhbmRhcmRQYXR0ZXJuKGNhcmQpKSB7XG4gICAgICBjb25zdCBtYXRjaGVzOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbCA9IHZhbHVlLm1hdGNoKGNhcmQucGF0dGVybik7XG5cbiAgICAgIGlmIChtYXRjaGVzID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cblxuICAgICAgY2FyZE51bU1heExlbmd0aCA9IGNhcmQubWF4TGVuZ3RoICsgbWF0Y2hlcy5sZW5ndGggLSAxO1xuICAgICAgdGhpcy5tYXhMZW5ndGggPSBjYXJkTnVtTWF4TGVuZ3RoLnRvU3RyaW5nKCk7XG4gICAgICByZXR1cm4gbWF0Y2hlcy5qb2luKHRoaXMuc2VwYXJhdG9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgcmVzdWx0czogUmVnRXhwRXhlY0FycmF5IHwgbnVsbCA9IGNhcmQucGF0dGVybi5leGVjKHZhbHVlKTtcblxuICAgICAgaWYgKHJlc3VsdHMgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgICAgcmVzdWx0cy5zaGlmdCgpO1xuICAgICAgY2FyZE51bU1heExlbmd0aCA9IGNhcmQubWF4TGVuZ3RoICsgcmVzdWx0cy5sZW5ndGggLSAxO1xuICAgICAgdGhpcy5tYXhMZW5ndGggPSBjYXJkTnVtTWF4TGVuZ3RoLnRvU3RyaW5nKCk7XG4gICAgICByZXR1cm4gcmVzdWx0cy5maWx0ZXIodGhpcy5pc01hdGNoKS5qb2luKHRoaXMuc2VwYXJhdG9yKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHJlbW92ZU5vbkRpZ2l0cyh2YWx1ZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gIH1cblxuICBwcml2YXRlIGhhc1N0YW5kYXJkUGF0dGVybihjYXJkOiBDcmVkaXRDYXJkKSB7XG4gICAgcmV0dXJuIGNhcmQucGF0dGVybi50b1N0cmluZygpID09PSB0aGlzLnN0YW5kYXJkUGF0dGVybi50b1N0cmluZygpO1xuICB9XG5cbiAgcHJpdmF0ZSBpc01hdGNoKG1hdGNoOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gbWF0Y2ggIT09IHVuZGVmaW5lZDtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlQ3VycmVudENhcmROYW1lcyhuYW1lOiBzdHJpbmcsIGZ1bGxOYW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLmNhcmROYW1lID0gbmFtZTtcbiAgICB0aGlzLmNhcmRGdWxsTmFtZSA9IGZ1bGxOYW1lO1xuICB9XG5cbiAgcHJpdmF0ZSBmaW5kQ2FyZEJ5TnVtYmVyKHZhbHVlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBjYXJkVHlwZSA9IHRoaXMuY2FyZHMuZmluZChjYXJkID0+IHtcbiAgICAgIHJldHVybiBjYXJkLnJlLnRlc3QodmFsdWUpO1xuICAgIH0pO1xuXG4gICAgaWYgKCFjYXJkVHlwZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdENhcmQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNhcmRUeXBlO1xuICB9XG5cbiAgcHVibGljIGFkZENhcmRzKG5ld0NhcmRzOiBDcmVkaXRDYXJkW10pIHtcbiAgICBuZXdDYXJkcy5mb3JFYWNoKGNhcmQgPT4ge1xuICAgICAgdGhpcy5jYXJkcy5wdXNoKGNhcmQpO1xuICAgIH0pO1xuICB9XG59XG4iXX0=